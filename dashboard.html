<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>KiÅŸisel Panel â€“ Self Training</title>
  <style>
    body{font-family:Arial,sans-serif;background:#f0f3f6;margin:0;padding:0}
    .container{max-width:600px;margin:40px auto;background:#fff;
      border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,.08);padding:24px}
    h1{margin:0 0 12px;text-align:center}
    label{font-weight:600;display:block;margin-top:10px}
    input{width:100%;padding:10px;border:1px solid #ccc;border-radius:8px;margin-top:4px}
    button{margin-top:16px;padding:12px;width:100%;border:none;border-radius:8px;
      background:#10b981;color:#fff;font-weight:600;cursor:pointer}
    button:hover{background:#0ea371}
    .result{margin-top:18px;padding:12px;border-radius:8px;background:#f9fafb}
    .chat{margin-top:24px;border-top:1px solid #e5e7eb;padding-top:16px}
    #chatBox{height:160px;overflow-y:auto;background:#f9fafb;border-radius:8px;
      padding:8px;margin-bottom:8px;font-size:15px}
    #chatInput{width:100%;padding:10px;border:1px solid #ccc;border-radius:8px}
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ‹ï¸â€â™‚ï¸ KiÅŸisel Panel</h1>
    <p id="welcome"></p>

    <label>YaÅŸ</label><input id="age" type="number" placeholder="Ã¶rn. 25">
    <label>Boy (cm)</label><input id="height" type="number" placeholder="Ã¶rn. 175">
    <label>Kilo (kg)</label><input id="weight" type="number" placeholder="Ã¶rn. 70">
    <label>Dinlenik NabÄ±z (RHR)</label><input id="rhr" type="number" placeholder="Ã¶rn. 65">
    <label>Bel Ã§evresi (cm)</label><input id="waist" type="number" placeholder="Ã¶rn. 80">
    <label>Boyun Ã§evresi (cm)</label><input id="neck" type="number" placeholder="Ã¶rn. 35">
    <label>KalÃ§a Ã§evresi (cm, kadÄ±nlar iÃ§in)</label><input id="hip" type="number" placeholder="Ã¶rn. 90">

    <button onclick="calc()">Hesapla ğŸ”</button>

    <div class="result" id="res"></div>

    <div class="chat">
      <h3>ğŸ’¬ ChatGPT Mini Asistan (demo)</h3>
      <div id="chatBox"></div>
      <input id="chatInput" placeholder="Bir ÅŸey yaz... (Ã¶rn. 'Kas geliÅŸtirmek istiyorum')" onkeydown="if(event.key==='Enter')chat()">
    </div>
  </div>

  <script>
    const userEmail = localStorage.getItem("currentUser");
    const users = JSON.parse(localStorage.getItem("users_v1")||"[]");
    const user = users.find(u=>u.email===userEmail);
    if(user){ document.getElementById("welcome").textContent=`Merhaba, ${user.name}! ğŸ¯ Hedefin: ${user.goal}` }

    function calc(){
      const age = +v("age"), h = +v("height"), w = +v("weight"), rhr = +v("rhr");
      const waist = +v("waist"), neck = +v("neck"), hip = +v("hip");
      if(!age||!h||!w||!rhr||!waist||!neck) return msg("LÃ¼tfen tÃ¼m temel Ã¶lÃ§Ã¼mleri doldur.");

      // BMI
      const bmi = (w / ((h/100)**2)).toFixed(1);
      // BMR (Mifflin-St Jeor)
      const bmr = user.gender==="male"
        ? (10*w + 6.25*h - 5*age + 5)
        : (10*w + 6.25*h - 5*age - 161);
      // HRmax ve Karvonen
      const hrmax = 220 - age;
      const karvLow = ((hrmax - rhr)*0.6 + rhr).toFixed(0);
      const karvHigh = ((hrmax - rhr)*0.8 + rhr).toFixed(0);
      // TDEE
      const activityMap = {sedentary:1.2, light:1.375, moderate:1.55, very:1.725, athlete:1.9};
      const tdee = (bmr * (activityMap[user.activity]||1.2)).toFixed(0);
      // YaÄŸ oranÄ± (US Navy)
      const bf = user.gender==="male"
        ? (86.010*Math.log10(waist-neck) - 70.041*Math.log10(h) + 36.76).toFixed(1)
        : (163.205*Math.log10(waist+hip-neck) - 97.684*Math.log10(h) - 78.387).toFixed(1);

      document.getElementById("res").innerHTML = `
        <b>BMI:</b> ${bmi} kg/mÂ²<br>
        <b>BMR:</b> ${bmr.toFixed(0)} kcal/gÃ¼n<br>
        <b>TDEE:</b> ${tdee} kcal/gÃ¼n<br>
        <b>Maks NabÄ±z:</b> ${hrmax} bpm<br>
        <b>Hedef NabÄ±z AralÄ±ÄŸÄ± (60â€“80%):</b> ${karvLow}â€“${karvHigh} bpm<br>
        <b>VÃ¼cut YaÄŸ %:</b> ${bf}%<br><br>
        <i>Bu deÄŸerlere gÃ¶re sana Ã¶zel antrenman planÄ± hazÄ±rlanÄ±yor...</i>
      `;
    }

    function v(id){return document.getElementById(id).value.trim()}
    function msg(t){document.getElementById("res").innerHTML=t;}

    function chat(){
      const box = document.getElementById("chatBox");
      const input = document.getElementById("chatInput");
      const text = input.value.trim();
      if(!text) return;
      box.innerHTML += `<div><b>Sen:</b> ${text}</div>`;
      input.value="";
      const reply = demoAI(text.toLowerCase());
      setTimeout(()=>box.innerHTML += `<div><b>AI:</b> ${reply}</div>`,500);
      box.scrollTop = box.scrollHeight;
    }

    function demoAI(q){
      if(q.includes("kas")) return "Kas geliÅŸtirmek iÃ§in haftada en az 3 gÃ¼n direnÃ§ antrenmanÄ± Ã¶neririm ğŸ’ª Protein alÄ±mÄ±nÄ± ihmal etme!";
      if(q.includes("yaÄŸ")) return "YaÄŸ yakÄ±mÄ± iÃ§in nabzÄ±nÄ± 60-70% HRmax aralÄ±ÄŸÄ±nda tut, dÃ¼zenli kardiyo ekle ğŸƒâ€â™‚ï¸";
      if(q.includes("motivasyon")) return "Bazen ilham deÄŸil disiplin iÅŸe yarar! Disiplinini koru ğŸ”¥";
      return "Harika! Hedefini koru, azim seni zirveye taÅŸÄ±r! ğŸš€";
    }
  </script>
</body>
</html>
