<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dashboard - Self Training</title>
  <style>
    body{font-family:Arial, sans-serif;background:#f2f2f2;margin:0}
    .card{max-width:640px;margin:40px auto;background:#fff;border:1px solid #ddd;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,.06)}
    .card h2{margin:0;padding:18px 20px;border-bottom:1px solid #eee}
    .content{padding:20px}
    label{display:block;margin:10px 0 6px;font-weight:600}
    input,select{width:100%;padding:10px;border:1px solid #ccc;border-radius:8px}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .row-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px}
    .btn{display:inline-block;background:#22c55e;color:#fff;border:none;border-radius:10px;padding:12px 16px;margin-top:14px;cursor:pointer}
    .btn.alt{background:#0ea5e9}
    .btn.ghost{background:#fff;color:#ef4444;border:1px solid #ef4444}
    .muted{color:#666;font-size:14px}
    .pill{display:inline-block;padding:4px 10px;border-radius:999px;background:#f1f5f9;font-size:12px;margin-right:6px}
    .grid{display:grid;gap:10px}
    .box{background:#f8fafc;border:1px solid #e5e7eb;border-radius:10px;padding:12px}
    .small{font-size:13px;color:#475569}
    .ok{color:#16a34a;font-weight:700}
    .warn{color:#f59e0b;font-weight:700}
    .bad{color:#dc2626;font-weight:700}
    .center{text-align:center}
  </style>
</head>
<body>
  <div class="card">
    <h2>HoÅŸ Geldiniz!</h2>
    <div class="content">

      <p class="muted">AÅŸaÄŸÄ±daki Ã¶lÃ§Ã¼mleri girin; BMI, BMR, VÃ¼cut YaÄŸ OranÄ±, Karvonen hedef nabÄ±zlarÄ± ve kiÅŸisel Ã¶zet otomatik hesaplanÄ±r.</p>

      <!-- TEMEL BÄ°LGÄ°LER -->
      <div class="row">
        <div>
          <label>YaÅŸ</label>
          <input id="age" type="number" min="8" max="100" placeholder="Ã¶rn. 24" />
        </div>
        <div>
          <label>Cinsiyet</label>
          <select id="gender">
            <option value="">SeÃ§iniz</option>
            <option value="male">Erkek</option>
            <option value="female">KadÄ±n</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div>
          <label>Boy (cm)</label>
          <input id="height" type="number" min="100" max="230" placeholder="Ã¶rn. 178" />
        </div>
        <div>
          <label>Kilo (kg)</label>
          <input id="weight" type="number" min="20" max="250" step="0.1" placeholder="Ã¶rn. 74.5" />
        </div>
      </div>

      <!-- Ã‡EVRELER (US Navy yaÄŸ oranÄ±) -->
      <div class="row">
        <div>
          <label>Bel Ã§evresi (cm)</label>
          <input id="waist" type="number" min="40" max="200" step="0.1" placeholder="gÃ¶bek hattÄ±" />
        </div>
        <div>
          <label>Boyun Ã§evresi (cm)</label>
          <input id="neck" type="number" min="20" max="60" step="0.1" placeholder="adam elmasÄ± altÄ±" />
        </div>
      </div>

      <div class="row">
        <div>
          <label>KalÃ§a Ã§evresi (cm) <span class="small">(kadÄ±nlar iÃ§in)</span></label>
          <input id="hip" type="number" min="50" max="200" step="0.1" placeholder="kadÄ±n: zorunlu, erkek: boÅŸ bÄ±rak" />
        </div>
        <div>
          <label>Dinlenik NabÄ±z â€“ RHR (dkâ»Â¹)</label>
          <input id="rhr" type="number" min="30" max="120" placeholder="Ã¶rn. 60" />
        </div>
      </div>

      <!-- TÄ°P & HEDEF -->
      <div class="row">
        <div>
          <label>VÃ¼cut Tipi</label>
          <select id="bodyType">
            <option value="">SeÃ§iniz</option>
            <option value="ektomorf">Ektomorf</option>
            <option value="mezomorf">Mezomorf</option>
            <option value="endomorf">Endomorf</option>
          </select>
        </div>
        <div>
          <label>Hedef</label>
          <select id="goal">
            <option value="">SeÃ§iniz</option>
            <option value="kas">Kas kÃ¼tlesi artÄ±rmak</option>
            <option value="yaÄŸ">YaÄŸ oranÄ±nÄ± dÃ¼ÅŸÃ¼rmek</option>
            <option value="kondisyon">Kondisyon kazanmak</option>
            <option value="esneklik">EsnekliÄŸi artÄ±rmak</option>
          </select>
        </div>
      </div>

      <button class="btn" id="calcBtn">Hesapla & Kaydet</button>
      <button class="btn alt" id="fillBtn">Ã–rnek deÄŸer doldur</button>
      <button class="btn ghost" id="clearBtn">TÃ¼m veriyi sil</button>

      <hr/>

      <!-- SONUÃ‡LAR -->
      <div class="grid">
        <div class="box">
          <div class="pill">BMI</div>
          <div id="bmiText" class="small">â€“</div>
        </div>

        <div class="box">
          <div class="pill">BMR (Mifflinâ€“St Jeor)</div>
          <div id="bmrText" class="small">â€“</div>
        </div>

        <div class="box">
          <div class="pill">VÃ¼cut YaÄŸ OranÄ± (US Navy)</div>
          <div id="bfText" class="small">â€“</div>
          <div id="lbmText" class="small">â€“</div>
        </div>

        <div class="box">
          <div class="pill">Karvonen Hedef NabÄ±zlar</div>
          <div id="hrText" class="small">â€“</div>
        </div>

        <div class="box">
          <div class="pill">AI KoÃ§ Ã–zeti</div>
          <div id="coachText" class="small">â€“</div>
        </div>
      </div>

      <p class="center small" style="margin-top:14px">
        <a href="index.html">KullanÄ±cÄ± deÄŸiÅŸtir / Ana sayfa</a>
      </p>

    </div>
  </div>

  <script>
    const $ = id => document.getElementById(id);

    // localStorage anahtarlarÄ±
    const KEY = "selfUser";

    // Sayfa aÃ§Ä±lÄ±ÅŸÄ±nda verileri getir
    (function init() {
      const raw = localStorage.getItem(KEY);
      if(!raw) return;
      try{
        const u = JSON.parse(raw);
        for (const [k,v] of Object.entries(u)) {
          if ($(k)) $(k).value = v;
        }
        computeAndRender();
      }catch(e){}
    })();

    // Ã–rnek doldur
    $('fillBtn').onclick = () => {
      $('age').value = 24;
      $('gender').value = 'male';
      $('height').value = 178;
      $('weight').value = 74.5;
      $('waist').value  = 82;
      $('neck').value   = 38;
      $('hip').value    = ''; // erkek
      $('rhr').value    = 60;
      $('bodyType').value = 'mezomorf';
      $('goal').value   = 'kas';
    };

    // Temizle
    $('clearBtn').onclick = () => {
      localStorage.removeItem(KEY);
      ['bmiText','bmrText','bfText','lbmText','hrText','coachText'].forEach(id=>$(id).textContent='â€“');
      document.querySelectorAll('input,select').forEach(el=>el.value='');
      alert('Veriler temizlendi.');
    };

    // Hesapla & kaydet
    $('calcBtn').onclick = () => {
      const data = grabInputs();
      const missing = validate(data);
      if (missing.length){
        alert('LÃ¼tfen ÅŸu alanlarÄ± doldurun: ' + missing.join(', '));
        return;
      }
      localStorage.setItem(KEY, JSON.stringify(data));
      computeAndRender();
      // ufak motivasyon
      alert('KayÄ±t baÅŸarÄ±lÄ±. AÅŸaÄŸÄ±daki Ã¶zet kiÅŸisel profiline gÃ¶re Ã¼retildi. ğŸ‘Œ');
    };

    function grabInputs(){
      return {
        age: +$('age').value,
        gender: $('gender').value,
        height: +$('height').value,
        weight: +$('weight').value,
        waist: +$('waist').value,
        neck: +$('neck').value,
        hip:  $('hip').value ? +$('hip').value : null,
        rhr: +$('rhr').value,
        bodyType: $('bodyType').value,
        goal: $('goal').value
      };
    }

    function validate(d){
      const required = ['age','gender','height','weight','waist','neck','rhr','bodyType','goal'];
      const miss = [];
      for(const k of required){
        if(d[k]===null || d[k]==='' || Number.isNaN(d[k])) miss.push(k);
      }
      if (d.gender==='female' && (!d.hip || Number.isNaN(d.hip))) miss.push('hip');
      return miss;
    }

    // Hesaplamalar
    function computeAndRender(){
      const d = grabInputs();

      // BMI
      const h = d.height/100;
      const bmi = d.weight / (h*h);
      const bmiCat = bmi<18.5 ? 'zayÄ±f' : bmi<25 ? 'normal' : bmi<30 ? 'fazla kilolu' : 'obez';
      $('bmiText').innerHTML = `BMI: <b>${bmi.toFixed(1)}</b> â†’ <span class="${bmiCat==='normal'?'ok':(bmiCat==='zayÄ±f'?'warn':'bad')}">${bmiCat}</span>`;

      // BMR (Mifflinâ€“St Jeor)
      const bmr = (d.gender==='male')
        ? (10*d.weight + 6.25*d.height - 5*d.age + 5)
        : (10*d.weight + 6.25*d.height - 5*d.age - 161);
      $('bmrText').innerHTML = `BMR: <b>${Math.round(bmr)}</b> kcal/gÃ¼n <span class="small">(yaklaÅŸÄ±k bazal enerji)</span>`;

      // US Navy Body Fat %
      const log10 = (x)=> Math.log(x)/Math.LN10;
      let bf = null;
      if (d.gender==='male'){
        // bel - boyun cm, boy cm
        if (d.waist>d.neck){
          bf = 495/(1.0324 - 0.19077*log10(d.waist - d.neck) + 0.15456*log10(d.height)) - 450;
        }
      }else{
        if (d.waist && d.hip && d.neck){
          bf = 495/(1.29579 - 0.35004*log10(d.waist + d.hip - d.neck) + 0.22100*log10(d.height)) - 450;
        }
      }
      if (bf!==null && isFinite(bf)){
        const lbm = d.weight * (1 - bf/100);
        $('bfText').innerHTML = `VÃ¼cut yaÄŸ oranÄ±: <b>${bf.toFixed(1)}%</b>`;
        $('lbmText').innerHTML = `YaÄŸsÄ±z kÃ¼tle (LBM): <b>${lbm.toFixed(1)} kg</b>`;
      } else {
        $('bfText').textContent = 'VÃ¼cut yaÄŸ oranÄ±: hesaplanamadÄ± (Ã¶lÃ§Ã¼leri kontrol edin).';
        $('lbmText').textContent = 'â€”';
      }

      // Karvonen hedef nabÄ±zlar
      const hrmax = 220 - d.age;               // basit formÃ¼l; ileride Tanaka opsiyonu eklenebilir
      const hrr   = hrmax - d.rhr;
      const zone  = (p)=> Math.round(d.rhr + hrr*p);
      const z1 = `${zone(0.60)}â€“${zone(0.70)} bpm (YaÄŸ yakÄ±m/tempo)`;
      const z2 = `${zone(0.70)}â€“${zone(0.80)} bpm (Kardiyo/geliÅŸim)`;
      const z3 = `${zone(0.80)}â€“${zone(0.90)} bpm (Tepe/interval)`;
      $('hrText').innerHTML = `HRmax â‰ˆ <b>${hrmax}</b> â€¢ RHR: <b>${d.rhr}</b><br>Hedef zonlar: ${z1} â€¢ ${z2} â€¢ ${z3}`;

      // AI koÃ§ kÄ±sa Ã¶zeti (hedef + vÃ¼cut tipine gÃ¶re)
      $('coachText').innerHTML = buildCoachNote(d, bmi, bf, bmr, {z1,z2,z3});
    }

    function buildCoachNote(d, bmi, bf, bmr, zones){
      const t = d.bodyType, g = d.goal;
      const tips = [];

      // vÃ¼cut tipine gÃ¶re 1 cÃ¼mle
      if (t==='ektomorf') tips.push("Ektomorf: yoÄŸun bileÅŸik hareketler + yÃ¼ksek kalori/karbonhidrat, haftada 3â€“4 tam vÃ¼cut antrenmanÄ±.");
      if (t==='mezomorf') tips.push("Mezomorf: kuvvet + hipertrofi dengesi (6â€“12 tekrar), haftada 4 gÃ¼n bÃ¶lgesel plan verimli.");
      if (t==='endomorf') tips.push("Endomorf: kalori kontrolÃ¼ + daha yÃ¼ksek NEAT + 3 gÃ¼n kuvvet, 2â€“3 gÃ¼n orta-Ã¼st seviye kardiyo.");

      // hedefe gÃ¶re 1 cÃ¼mle
      if (g==='kas') tips.push("Hedef kas: 1RMâ€™in %65â€“80 aralÄ±ÄŸÄ±, 6â€“12 tekrar, set arasÄ± 60â€“120 sn; gÃ¼nlÃ¼k protein ~1.6â€“2.2 g/kg.");
      if (g==='yaÄŸ') tips.push("Hedef yaÄŸ: haftalÄ±k %0.5â€“1 kilo kaybÄ± hedefle; kuvveti koru, kardiyoda " + zones.z1 + " aralÄ±ÄŸÄ±nÄ± kullan.");
      if (g==='kondisyon') tips.push("Hedef kondisyon: interval/tempo koÅŸularÄ±nÄ± " + zones.z2 + " bandÄ±nda planla; haftada 2 kuvvet ekle.");
      if (g==='esneklik') tips.push("Hedef esneklik: her antrenman sonrasÄ± 10â€“15 dk statik germe + haftada 2 mobilite seansÄ±.");

      // gÃ¼venlik/Ã¶zet
      const bmiInfo = isFinite(bmi) ? `BMI ${bmi.toFixed(1)}` : 'BMI -';
      const bfInfo  = (bf && isFinite(bf)) ? ` â€¢ YaÄŸ % ${bf.toFixed(1)}` : '';
      tips.push(`Ã–zet: ${bmiInfo}${bfInfo} â€¢ BMR â‰ˆ ${Math.round(bmr)} kcal â€¢ NabÄ±z zonlarÄ±nÄ± kullan.`);

      return tips.join(" ");
    }
  </script>
</body>
</html>
